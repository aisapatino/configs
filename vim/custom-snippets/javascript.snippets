# by default, only expands if at beginning of line or after whitespace
# options:
#	 b  beginning of line only (not after whitespace)
#	 w  word boundary (can be adjacent to non-word, non-whitespace chars)
#	 i  in-word expansion allowed
#	 s  trim trailing whitespace before going to next line
# 	  (useful when there are optional params after a tab)

#------------------------------------------------------------------------------
# GENERAL
#------------------------------------------------------------------------------

snippet str "use strict statement" b
"use strict";
endsnippet

# functions
# ---------

snippet pf "prototype function" ws
prototype.${1:FUNC_NAME} = function $1(${2:PARAMS}) {
	${3}
};

endsnippet

snippet of "object function" ws
${1:FUNC_NAME} = function $1(${2:PARAMS}) {
	${3}
};

endsnippet

snippet fn "anon callback function es6" ws
(${1}) => {
	${2}
});${3}
endsnippet

snippet fa "anon function with args" ws
function (${1}) {
	${2}
})
endsnippet

snippet fas "anon function with args & semicolon" ws
function (${1}) {
	${2}
});
endsnippet

snippet af "arrow function" ws
(${1}) => {
	${2}
});${3}
endsnippet

# console logging
# ---------------

snippet co "console.log" w
console.log(${1});
endsnippet

snippet con "console.log with quotes" w
console.log("${1}"${2});
endsnippet

#------------------------------------------------------------------------------
# NODE
#------------------------------------------------------------------------------

snippet cr "es6 matching require" b
const ${1} = require("$1");
endsnippet

snippet cre "es6 non-matching require" b
const ${1} = require("$2");
endsnippet

snippet req "generic matching require" b
var ${1} = require('$1');
endsnippet

snippet re "generic non-matching require" b
var ${1} = require('${2}');
endsnippet

#------------------------------------------------------------------------------
# TESTING
#------------------------------------------------------------------------------

# mocha
# ------

snippet desc "skeleton for describe wrapper es6" s
describe("${1:SUITE DESC}", () => {
	${2}
});
endsnippet

snippet be "beforeEach es6"
beforeEach((${1}) => {
	${2}
});

endsnippet

snippet it "skeleton for single it, sync es6" s
it("should ${1:TEST DESC}", () => {
	${2}
});

endsnippet

snippet iti "skeleton for single skipped it (with done cb)" s
it.skip("should ${1:TEST DESC}", function (done) {
});

endsnippet

snippet ita "skeleton for single sync it async" s
it("should ${1:TEST DESC}", function () {
	${2}
});

endsnippet

snippet tt "test then (with catch done)" ws
then(function (${1:results}) {
	${2}
	done();
})
.catch(done);
endsnippet

# supertest-as-promised
# ---------------------

snippet tget "test request" s
request.${1:get}('${2:URL}')
	.expect(${3:200})
	.then(function (res) {
		${4}
		done();
	})
	.catch(done);
endsnippet

# chai bdd
# --------

snippet tf "test file - require expect" b
'use strict';

var expect = require('chai').expect;

${1}
endsnippet

snippet exp "expect" s
expect(${1:VAR}).to.${2:ETC};
endsnippet

snippet ep "expect property"
expect(${1}).to.have.property("${2}"${3});
endsnippet

snippet epp "expect property that is a..."
expect(${1}).to.have.property("${2}").that.is.a${3}("${4}");
endsnippet

snippet et "expect type" s
expect(${1}).to.be.a${2}("${3}")${4};
endsnippet

# nock
# -----

snippet nock "nock outline" sw
nock
	.${1:METHOD}('/${2:URL}')
	.reply(${3:200}, ${4:DATA});
endsnippet

#------------------------------------------------------------------------------
# BACKBONE & MARIONETTE
#------------------------------------------------------------------------------

snippet model "outline for Backbone Model"
'use strict';

var Model = require('backbone').Model;

module.exports = Model.extend({

});
endsnippet

# specific to project
snippet coll "outline of Backbone Collection"
'use strict';

var assert = require('assert');
var Collection = require('backbone').Collection;

var config = require('../config');

module.exports = Collection.extend({

	url: function () {
		return config.server + ${1:''};
	},

	initialize: function initialize(options) {
		assert(options.${2:prop}, 'options.$2 is required');
	}
});
endsnippet

snippet layout "LayoutView"
'use strict';

var assert = require('assert');
var LayoutView = require('marionette').LayoutView;

var template = require('templates/${1:TEMPLATE}.jade');

module.exports = LayoutView.extend({

	template: template,

	regions: {${2}},

	// Initialization
	// ---------------

	initialize: function initialize(options) {
		// assert required options
		// create models and collections

		// create child views, call listener setup (or in onAttach)
	},

	onAttach: function onAttach() {
		// this.showChildView('region', view);
	},

	// View events
	// -----------

	addViewListeners: function addViewListeners() {
	},

	// Collection events
	// -----------------

	addCollectionListeners: function addCollectionListeners() {
	},

	// Private methods
	// ---------------
});
endsnippet

snippet iview "Marionette ItemView" bs
'use strict';

var assert = require('assert');
var Marionette = require('marionette');

var template = require('templates/${1:TEMPLATE}.jade');

module.exports = Marionette.ItemView.extend({
	template: template,

	initialize: function initialize(options) {
		assert(options.${2:model}, 'options.$2 is required');
		this.listenTo(this.$2, 'sync', this.render);
		this.$2.fetch();
	},

	// View events
	// -----------
	events: {
	},

	// Template helpers
	// ----------------

	templateHelpers: function templateHelpers() {
		return {};
	}
});
endsnippet

#-----------------------------------------------------------------------------
# JSDOC
#-----------------------------------------------------------------------------

snippet param "@param" ws
@param {${1:TYPE}} ${2:NAME} - ${3:DESC}
endsnippet

#-----------------------------------------------------------------------------
# ESLINT
#-----------------------------------------------------------------------------

snippet dl "disable line" ws
// eslint-disable-line ${1}
endsnippet

snippet dis "eslint disable"
/* eslint-disable ${1} */
endsnippet

snippet en "eslint enable"
/* eslint-enable ${1} */
endsnippet
